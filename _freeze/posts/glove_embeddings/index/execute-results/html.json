{
  "hash": "0c618363e259b26daba48a8be477c7f4",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"How Machines Comprehend Language<br><sub>Global Vectors for Word Representation</sub>\"\nauthor: \"Jonathan Dekermanjian\"\ndate: \"2025-09-13\"\ncategories: [Natural Language Processing]\ncode-annotations: below\nimage: \"thumbnail.png\"\njupyter: jax_recsys\nexecute: \n  cache: true\n---\n\n# Overview\n\nA deep dive on the Global Vectors for Word Representation (GloVe) algorithm with an implementation in JAX.\n\n# Introduction\n\nIn this short post, we’ll do a deep dive on the Global Vectors for Word Representation (GloVe) algorithm. Like Skip-Gram with Negative Sampling (SGNS), GloVe produces dense, static embeddings. These embeddings have a fixed dimension (commonly 300), and each token in the vocabulary is assigned a single embedding, irrespective of multiple word senses.\n\nGloVe learns word relationships from global co-occurrence statistics. To begin, we construct a co-occurrence matrix over our corpus, which in this case is the same dataset we used in the [Skip-Gram With Negative Sampling](/posts/skipgram_embeddings/index.qmd) post.\n\nThe core idea is straightforward: the model minimizes the weighted squared error between the logarithm of observed co-occurrences and their predicted values. Let’s dive in!\n\n\n## Preprocessing Utilities\n\nWe are going to use the same preprocessing functions (tokenization, tokens-to-index, etc...) that we used when we went over the [Skip-Gram With Negative Sampling](/posts/skipgram_embeddings/index.qmd) algorithm. These are shown again below for your reference.\n\n::: {#a03b6788 .cell execution_count=1}\n``` {.python .cell-code}\n# Imports\nimport jax\nimport jax.numpy as jnp\nimport numpy as np\nfrom jax import random, jit, grad\nfrom flax import linen as nn\nfrom nltk.tokenize import word_tokenize, sent_tokenize\nfrom collections import Counter\nimport optax\nimport plotly.graph_objects as go\nimport plotly.io as pio\nimport umap\nfrom figure_template import add_figure_templates\n```\n:::\n\n\n::: {#d0814d5d .cell execution_count=2}\n``` {.python .cell-code}\ndef tokenize_and_filter(text: str, min_occurrence: int) -> list[str]:\n    \"\"\"\n    Tokenizes input text and filters out tokens that occur less than or equal to `min_occurrence` times.\n\n    Parameters\n    ----------\n    text: str\n        Input text to be tokenized.\n    min_occurrence: int\n        Minimum number of times a token must appear in the text to be included.\n\n    Returns\n    -------\n    list[str]: \n        A list of tokens that occur more than `min_occurrence` times.\n    \"\"\"\n    # Convert text to lowercase and tokenize\n    tokens = word_tokenize(text.lower().strip())\n\n    # Count occurrences of each token\n    token_counts = Counter(tokens)\n\n    # Filter tokens based on minimum occurrence threshold\n    filtered_tokens = [token for token in tokens if token_counts[token] > min_occurrence]\n\n    return filtered_tokens\n```\n:::\n\n\n::: {#9dc46efb .cell execution_count=3}\n``` {.python .cell-code}\ndef build_word_index(text: str, min_occurence: int = 0) -> tuple[dict[str, int], list[str]]:\n    \"\"\"\n    Builds a word-to-index mapping (vocabulary) from input text, including a special <unk> token.\n\n    Parameters\n    ----------\n    text: str\n        Input text to extract vocabulary from.\n    min_occurrence: int\n        Minimum number of times a token must appear in the text to be included.\n\n    Returns\n    -------\n    Tuple[Dict[str, int], List[str]]: \n        - word_to_index: A dictionary mapping each word to a unique integer ID.\n        - vocabulary: A sorted list of unique vocabulary words including \"<unk>\".\n    \"\"\"\n    # Tokenize and get unique words\n    unique_tokens = set(tokenize_and_filter(text, min_occurrence=min_occurence))\n\n    # Add special token for unknown words\n    vocabulary = sorted(unique_tokens) + [\"<unk>\"]\n\n    # Create word-to-index mapping\n    word_to_index = {word: idx for idx, word in enumerate(vocabulary)}\n\n    return word_to_index, vocabulary\n```\n:::\n\n\n::: {#608496c5 .cell execution_count=4}\n``` {.python .cell-code}\ndef tokens_to_ids(text: str, word_to_index: dict[str, int], min_occurence: int = 0) -> list[int]:\n    \"\"\"\n    Converts a text string into a list of integer token IDs using a provided word-to-index mapping.\n    Unknown tokens are mapped to the ID of the \"<unk>\" token.\n\n    Parameters\n    ----------\n    text: str\n        Input text to convert.\n    word_to_index: dict[str, int]\n        A dictionary mapping words to their corresponding integer IDs.\n    min_occurrence: int\n        Minimum number of times a token must appear in the text to be included.\n\n    Returns\n    -------\n    list[int]:\n        A list of integer IDs representing the tokenized input text.\n    \"\"\"\n    tokens = tokenize_and_filter(text, min_occurrence=min_occurence)\n    token_ids = [word_to_index.get(token, word_to_index[\"<unk>\"]) for token in tokens]\n    return token_ids\n```\n:::\n\n\n# Global Vectors for Word Representation (GloVe)\n\nConceptually, GloVe is simpler than Skip-Gram with Negative Sampling (SGNS) because it avoids negative sampling and works directly with co-occurrence statistics. However, in practice SGNS can be easier to scale to very large corpora, since GloVe requires building and storing a co-occurrence matrix in memory. \n\nThat being said let's take a look at how we can generate our co-occurrence matrix. \n\n## Co-occurence Matrices \n\nIn addition to creating the matrix, we need a utility that uses this matrix and returns a tuple of row indices, column indices, and co-occurrence counts. This is how we will pass the information to our loss function. \n\n::: {#86b256d7 .cell execution_count=5}\n``` {.python .cell-code}\ndef build_cooc_matrix(corpus_tokens: list[str], vocabulary: list[str], word_to_index: dict[str, int], window_size: int = 5) -> np.ndarray:\n    \"\"\"\n    Build a co-occurrence matrix of a specified window size.\n    \n    Parameters\n    ----------\n    corpus_tokens: list[str] \n        tokenized text corpus\n    vocabulary: list[str]\n        sorted vocabulary\n    word_to_index: dict[str, int]\n        mapping from word to index in vocab\n    window_size: int \n        number of words to consider on each side\n    \n    Returns\n    -------\n    np.ndarray \n        cooc of shape (vocabulary_size, vocabulary_size)\n    \"\"\"\n    vocab_size = len(vocabulary)\n    cooc_matrix = np.zeros((vocab_size, vocab_size), dtype=np.float32)\n    \n    for idx, word in enumerate(corpus_tokens):\n        if word not in word_to_index:\n            continue  # skip OOV words\n        i = word_to_index[word]\n        \n        # Context window boundaries\n        start = max(0, idx - window_size)\n        end = min(len(corpus_tokens), idx + window_size + 1)\n        \n        for j in range(start, end):\n            if j == idx:\n                continue  # skip the word itself\n            context_word = corpus_tokens[j]\n            if context_word not in word_to_index:\n                continue\n            k = word_to_index[context_word]\n            \n            distance = abs(j - idx)\n            cooc_matrix[i, k] += 1.0 / distance  # inverse distance weighting\n    \n    return cooc_matrix\n\n\ndef cooc_matrix_to_arrays(cooc_matrix: np.ndarray) -> tuple[np.ndarray, np.ndarray, np.ndarray]:\n    \"\"\"\n    Convert a dense co-occurrence matrix to separate arrays of indices and counts.\n    \n    Parameters\n    ----------\n    cooc_matrix: np.ndarray\n        cooccurrence matrix\n        \n    Returns\n    -------\n    i_indices: np.ndarray[int32]\n    j_indices: np.ndarray[int32]\n    counts: np.ndarray[float32]\n    \"\"\"\n    i_indices, j_indices = np.nonzero(cooc_matrix)\n    counts = cooc_matrix[i_indices, j_indices]\n    \n    return (\n        i_indices.astype(np.int32),\n        j_indices.astype(np.int32),\n        counts.astype(np.float32),\n    )\n```\n:::\n\n\n## Loss Function\n\nThe loss function is straightforward: we approximate the logarithm of co-occurrence counts. The model uses two embedding matrices (for target and context words) and a bias term for each. The predicted value is the dot product of the embeddings plus the biases, and we minimize the squared error between this prediction and the true log co-occurrence. Importantly, the error is weighted by a function of the co-occurrence count, which downweights very rare pairs and caps the influence of very frequent ones.\n\nMore formally the loss function is:\n$$\nJ = \\sum_{i,j}f(X_{ij})(w_{i}^{T}u_{j} + b_{i} + b_{j} - logX_{ij})^{2}\n$$\n\nWhere $f()$ is the weighting function, $w$ and $u$ are the embeddings matrices, and $b$'s are the biases.\n\n::: {#2767ef42 .cell execution_count=6}\n``` {.python .cell-code}\ndef weighting_fn(x: np.ndarray, xmax: int = 100, alpha: float = 0.75):\n    return jnp.where(x < xmax, (x / xmax) ** alpha, 1.0)\n\ndef glove_loss(params: tuple[jnp.ndarray], cooc_i: jnp.ndarray, cooc_j: jnp.ndarray, X_ij: jnp.ndarray):\n    W, W_tilde, b, b_tilde = params\n    wi = W[cooc_i]\n    wj = W_tilde[cooc_j]\n    bi = b[cooc_i]\n    bj = b_tilde[cooc_j]\n\n    pred = jnp.sum(wi * wj, axis=1) + bi + bj\n    logX = jnp.log(jnp.maximum(X_ij, 1e-10))\n    fX = weighting_fn(X_ij)\n    loss = jnp.sum(fX * (pred - logX) ** 2)\n    return loss\n```\n:::\n\n\n# Learning Embeddings\n\nNow, for the hands-on portion, we are going to use the same dataset that we compiled in the [previous post](/posts/skipgram_embeddings/index.qmd). We are going to load the data and create our tokens, indexes, and tokenize sentences exactly as we did previously. However, this time around we are going to pre-compute the co-occurence matrix and structure the elements of the matrix into row indexes, column indexes, and counts.\n\n## Load and Process Dataset\n\n::: {#29bfaee7 .cell execution_count=7}\n``` {.python .cell-code}\nwith open('./political_corpus.txt', 'r', encoding='utf-8') as file:\n    text = file.read()\n```\n:::\n\n\n::: {#2a627341 .cell execution_count=8}\n``` {.python .cell-code}\nraw_tokens = tokenize_and_filter(text, min_occurrence=10)\nword_to_index, vocabulary = build_word_index(text=text, min_occurence=10)\nindex_to_word = {v:k for k,v in word_to_index.items()}\ncooc_matrix = build_cooc_matrix(raw_tokens, vocabulary, word_to_index, 10)\ni_indices, j_indices, counts = cooc_matrix_to_arrays(cooc_matrix)\n```\n:::\n\n\n## Define Training Loop\n\nOur training loop is very similar to what we had in the previous post, however, we wrap everything up in functions for a cleaner representation. \n\n::: {#88d36f74 .cell execution_count=9}\n``` {.python .cell-code}\ndef nearest_neighbors(word: str, vectors: jnp.ndarray, k:int = 3) -> list[str]:\n    \"\"\"\n    Finds k nearest neighbors to the given word using cosine similarity.\n\n    Parameters\n    ----------\n    word: str\n        Target word as a string.\n    vectors:  \n        Trained Embeddings\n    k: int\n        Number of nearest neighbors to return\n\n    Returns\n    -------\n    List[str]\n        Nearest neighbor tokens to word token\n    \"\"\"\n    index = tokens_to_ids(word, word_to_index)\n    query = vectors[index[0]]\n\n    # Normalize vectors and query\n    vectors_norm = vectors / jnp.linalg.norm(vectors, axis=1, keepdims=True)\n    query_norm = query / jnp.linalg.norm(query)\n\n    # Compute cosine similarities\n    similarities = jnp.dot(vectors_norm, query_norm)\n\n    # Get top 10 indices (excluding the word itself)\n    top_indices = jnp.argsort(similarities)[::-1][1:k+1]\n\n    # Map back to words\n    return [index_to_word[idx] for idx in np.array(top_indices)]\n```\n:::\n\n\n::: {#be55c572 .cell execution_count=10}\n``` {.python .cell-code}\ndef log_step(epoch, params, total_loss, n_samples):\n    \"\"\"\n    Simple function to print out summaries after each epoch\n    \"\"\"\n    print(f\"Epoch {epoch+1}, Avg Loss: {total_loss / n_samples:.4f}\")\n    # Log embeddings!\n    embeddings = params[0] + params[1]\n    print('\\nLearned embeddings:')\n    print(f'word: \"tyranny\" neighbors: {nearest_neighbors(\"tyranny\", embeddings)}\\n')\n\ndef train_glove(\n    i_indices: np.ndarray, \n    j_indices: np.ndarray, \n    counts: np.ndarray, \n    vocab_size: int, \n    dim: int = 300, \n    epochs: int = 50, \n    lr: float = 1e-3, \n    batch_size: int = 512\n):\n    \"\"\"\n    \n    \"\"\"\n    key = jax.random.PRNGKey(0)\n    W = jax.random.normal(key, (vocab_size, dim)) * 0.01\n    W_tilde = jax.random.normal(key, (vocab_size, dim)) * 0.01\n    b = jnp.zeros(vocab_size)\n    b_tilde = jnp.zeros(vocab_size)\n    params = (W, W_tilde, b, b_tilde)\n\n    opt = optax.adam(lr)\n    opt_state = opt.init(params)\n\n    n_samples = len(counts)\n\n    @jax.jit\n    def update(params: tuple[jnp.ndarray], opt_state, cooc_i: jnp.ndarray, cooc_j: jnp.ndarray, X_ij: jnp.ndarray):\n        loss, grads = jax.value_and_grad(glove_loss)(params, cooc_i, cooc_j, X_ij)\n        updates, opt_state = opt.update(grads, opt_state)\n        params = optax.apply_updates(params, updates)\n        return params, opt_state, loss\n\n    for epoch in range(epochs):\n        total_loss = 0.0\n        # shuffle each epoch\n        perm = np.random.permutation(n_samples)\n        for start in range(0, n_samples, batch_size):\n            end = min(start + batch_size, n_samples)\n            batch_idx = perm[start:end]\n            cooc_i = jnp.array(i_indices[batch_idx])\n            cooc_j = jnp.array(j_indices[batch_idx])\n            X_ij = jnp.array(counts[batch_idx])\n            params, opt_state, loss = update(params, opt_state, cooc_i, cooc_j, X_ij)\n            total_loss += float(loss) * len(batch_idx)\n\n        log_step(epoch, params, total_loss, n_samples)\n\n    return params\n```\n:::\n\n\n## Train\n\nAlright, let's run through our training loop!!\n\n::: {#d052a92f .cell execution_count=11}\n``` {.python .cell-code}\ntrained_params = train_glove(\n    i_indices,\n    j_indices,\n    counts,\n    len(vocabulary),\n)\n\nembeddings = trained_params[0] + trained_params[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nEpoch 1, Avg Loss: 30.8074\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['choice', 'authorities', 'defects']\n\nEpoch 2, Avg Loss: 12.0077\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['defects', 'encroachments', 'organization']\n\nEpoch 3, Avg Loss: 9.5171\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['appointing', 'judicial', 'physical']\n\nEpoch 4, Avg Loss: 7.1958\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['causes', 'principal', 'judicial']\n\nEpoch 5, Avg Loss: 5.5379\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['causes', 'arbitrary', 'principal']\n\nEpoch 6, Avg Loss: 4.3948\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['arbitrary', 'causes', 'iii']\n\nEpoch 7, Avg Loss: 3.5873\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['arbitrary', 'causes', 'anarchy']\n\nEpoch 8, Avg Loss: 2.9879\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['arbitrary', 'anarchy', 'iii']\n\nEpoch 9, Avg Loss: 2.5295\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['arbitrary', 'anarchy', 'causes']\n\nEpoch 10, Avg Loss: 2.1881\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['arbitrary', 'anarchy', 'majority']\n\nEpoch 11, Avg Loss: 1.9223\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['anarchy', 'arbitrary', 'majority']\n\nEpoch 12, Avg Loss: 1.7164\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['anarchy', 'arbitrary', 'iii']\n\nEpoch 13, Avg Loss: 1.5604\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['arbitrary', 'majority', 'anarchy']\n\nEpoch 14, Avg Loss: 1.4382\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['majority', 'anarchy', 'administration']\n\nEpoch 15, Avg Loss: 1.3376\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['majority', 'anarchy', 'administration']\n\nEpoch 16, Avg Loss: 1.2611\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['majority', 'iii', 'administration']\n\nEpoch 17, Avg Loss: 1.1893\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'anarchy', 'iii']\n\nEpoch 18, Avg Loss: 1.1444\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['majority', 'administration', 'iii']\n\nEpoch 19, Avg Loss: 1.0996\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['majority', 'administration', 'anarchy']\n\nEpoch 20, Avg Loss: 1.0615\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['majority', 'administration', 'iii']\n\nEpoch 21, Avg Loss: 1.0228\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'majority', 'arbitrary']\n\nEpoch 22, Avg Loss: 1.0045\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'majority', 'iii']\n\nEpoch 23, Avg Loss: 0.9816\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'majority', 'iii']\n\nEpoch 24, Avg Loss: 0.9568\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'majority', 'iii']\n\nEpoch 25, Avg Loss: 0.9430\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'majority', 'iii']\n\nEpoch 26, Avg Loss: 0.9328\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'majority', 'mass']\n\nEpoch 27, Avg Loss: 0.9034\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'majority', 'mass']\n\nEpoch 28, Avg Loss: 0.9004\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['majority', 'administration', 'mass']\n\nEpoch 29, Avg Loss: 0.8919\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['mass', 'administration', 'majority']\n\nEpoch 30, Avg Loss: 0.8782\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['majority', 'administration', 'mass']\n\nEpoch 31, Avg Loss: 0.8742\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['majority', 'administration', 'arbitrary']\n\nEpoch 32, Avg Loss: 0.8549\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'majority', 'mass']\n\nEpoch 33, Avg Loss: 0.8482\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'iii', 'majority']\n\nEpoch 34, Avg Loss: 0.8530\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'iii', 'mass']\n\nEpoch 35, Avg Loss: 0.8392\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'majority', 'action']\n\nEpoch 36, Avg Loss: 0.8356\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['administration', 'mass', 'action']\n\nEpoch 37, Avg Loss: 0.8258\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['mass', 'action', 'administration']\n\nEpoch 38, Avg Loss: 0.8254\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['mass', 'administration', 'majority']\n\nEpoch 39, Avg Loss: 0.8133\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['majority', 'action', 'administration']\n\nEpoch 40, Avg Loss: 0.8121\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['action', 'mass', 'iii']\n\nEpoch 41, Avg Loss: 0.8074\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['majority', 'mass', 'action']\n\nEpoch 42, Avg Loss: 0.8145\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['action', 'administration', 'mass']\n\nEpoch 43, Avg Loss: 0.7947\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['mass', 'action', 'majority']\n\nEpoch 44, Avg Loss: 0.8011\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['mass', 'action', 'administration']\n\nEpoch 45, Avg Loss: 0.7941\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['action', 'administration', 'iii']\n\nEpoch 46, Avg Loss: 0.7883\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['mass', 'majority', 'action']\n\nEpoch 47, Avg Loss: 0.7911\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['mass', 'action', 'arbitrary']\n\nEpoch 48, Avg Loss: 0.7877\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['action', 'mass', 'administration']\n\nEpoch 49, Avg Loss: 0.7827\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['mass', 'administration', 'action']\n\nEpoch 50, Avg Loss: 0.7800\n\nLearned embeddings:\nword: \"tyranny\" neighbors: ['action', 'mass', 'majority']\n\n```\n:::\n:::\n\n\n# Inspect learned embeddings\n\nWe use the same nearest neighbors approach to inspect our learned embeddings, as we did in the previous post. However, we added a plotting utility to plot the nearest neighbors after reducing the vector embeddings dimensions using UMAP. It's a little more exciting to have a visual, I suppose. \n\nLooking at the results, below, it is apparent that our embeddings have learned word relationships based on the cooccurrences within the corpus.\n\n::: {#019bf3c4 .cell execution_count=12}\n``` {.python .cell-code}\ndef reduce_umap(vectors, n_components=2, normalize=True, n_neighbors=10, min_dist=0.1, seed=13265):\n    \"\"\"simple dimensionality reduction for plotting\"\"\"\n    arr = np.array(vectors)\n    if normalize:\n        arr = arr / np.linalg.norm(arr, axis=1, keepdims=True)\n    reducer = umap.UMAP(\n        n_components=n_components,\n        n_neighbors=n_neighbors,\n        min_dist=min_dist,\n        random_state=seed,\n        metric='cosine', \n        n_jobs=1\n    )\n    return reducer.fit_transform(arr)\n\ndef plot_neighbors(word: str, vectors: jnp.ndarray, k: int = 5, theme=\"light\"):\n    \"\"\"\n    Create a 2D Plotly scatterplot of nearest neighbors for a given word.\n    \n    Parameters\n    ----------\n    word: str\n        Target word.\n    vectors: jnp.ndarray\n        Trained embedding matrix.\n    k: int\n        Number of neighbors.\n    theme: str\n        The plots theme (light, dark)\n        \n    Returns\n    -------\n    plotly.graph_objects.Figure\n    \"\"\"\n    add_figure_templates()\n    if theme == \"light\":\n        template = pio.templates[\"mantine_light\"]\n    else:\n        template = pio.templates[\"mantine_dark\"]\n\n    # Get neighbors\n    neighbors = nearest_neighbors(word, vectors, k=k)\n    words = [word] + neighbors\n    \n    # Get their embeddings\n    indices = np.array([tokens_to_ids(w, word_to_index)[0] for w in words])\n    emb = np.array(vectors[indices])\n    \n    # Reduce to 2D\n    emb_2d = reduce_umap(emb, 2, True, k)\n    \n    # plotly scatter plot\n    fig = go.Figure()\n    \n    fig.add_trace(\n        go.Scatter(\n            x = emb_2d[:,0],\n            y = emb_2d[:,1],\n            mode=\"markers+text\",\n            marker = dict(\n                color=[\"red\"] + [\"blue\"]*k,\n                symbol=[\"star\"] + [\"circle\"]*k,\n                size=14\n            ),\n            text=words,\n            textposition=\"top center\"\n        )\n    )\n    return fig.update_layout(\n        title = f\"Nearest neighbors of '{word}'\",\n        template=template\n    )\n```\n:::\n\n\n::: {#a70d839f .cell .light-mode execution_count=13}\n``` {.python .cell-code}\nplot_neighbors(\"pennsylvania\", embeddings, 10, \"light\")\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.3.1.min.js\" integrity=\"sha256-4rD3fugVb/nVJYUv5Ky3v+fYXoouHaBSP20WIJuEiWg=\" crossorigin=\"anonymous\"></script>                <div id=\"f32d0a3c-ce63-4a49-9c00-198a954c6d1a\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"f32d0a3c-ce63-4a49-9c00-198a954c6d1a\")) {                    Plotly.newPlot(                        \"f32d0a3c-ce63-4a49-9c00-198a954c6d1a\",                        [{\"marker\":{\"color\":[\"red\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\"],\"size\":14,\"symbol\":[\"star\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\"]},\"mode\":\"markers+text\",\"text\":[\"pennsylvania\",\"delaware\",\"carolina\",\"maryland\",\"virginia\",\"1832\",\"york\",\"1650\",\"connecticut\",\"massachusetts\",\"island\"],\"textposition\":\"top center\",\"x\":{\"dtype\":\"f4\",\"bdata\":\"+B3\\u002fwNzH58DFSejAzIX7wLPWB8FVhd7AzqMAwe67zcCRS9TA6Z4Kwdcmx8A=\"},\"y\":{\"dtype\":\"f4\",\"bdata\":\"NOYQQdLjC0H6cBpB\\u002fQ8dQf1aIEHTKydB9CcFQY51HEH\\u002foQpBbCQDQRtaA0E=\"},\"type\":\"scatter\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#ffffff\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scattermap\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermap\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#ffffff\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#1864ab\"],[0.14285714285714285,\"#7065b9\"],[0.2857142857142857,\"#af61b7\"],[0.42857142857142855,\"#e35ea5\"],[0.5714285714285714,\"#ff6587\"],[0.7142857142857143,\"#ff7c63\"],[0.8571428571428571,\"#ff9e3d\"],[1.0,\"#fcc419\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#228be6\",\"#fa5252\",\"#40c057\",\"#7950f2\",\"#fd7e14\",\"#15aabf\",\"#e64980\",\"#fab005\"],\"font\":{\"color\":\"#2a3f5f\",\"family\":\"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji\"},\"geo\":{\"bgcolor\":\"#ffffff\",\"lakecolor\":\"#ffffff\",\"landcolor\":\"#ffffff\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#C8D4E3\"},\"hoverlabel\":{\"align\":\"left\",\"font\":{\"family\":\"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji\"}},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"#ffffff\",\"piecolorway\":[\"#228be6\",\"#fa5252\",\"#40c057\",\"#7950f2\",\"#fd7e14\",\"#15aabf\",\"#e64980\",\"#fab005\"],\"plot_bgcolor\":\"#ffffff\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"radialaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"yaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"zaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"caxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#dee2e6\",\"gridwidth\":0.5,\"linecolor\":\"#EBF0F8\",\"rangeselector\":{\"activecolor\":\"#868e96\",\"bgcolor\":\"#adb5bd\",\"font\":{\"color\":\"white\"}},\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#dee2e6\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#dee2e6\",\"gridwidth\":0.5,\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#dee2e6\",\"zerolinewidth\":2}}},\"title\":{\"text\":\"Nearest neighbors of 'pennsylvania'\"}},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('f32d0a3c-ce63-4a49-9c00-198a954c6d1a');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };            </script>        </div>\n```\n:::\n:::\n\n\n::: {#096af19f .cell .dark-mode execution_count=14}\n``` {.python .cell-code}\nplot_neighbors(\"pennsylvania\", embeddings, 10, \"dark\")\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.3.1.min.js\" integrity=\"sha256-4rD3fugVb/nVJYUv5Ky3v+fYXoouHaBSP20WIJuEiWg=\" crossorigin=\"anonymous\"></script>                <div id=\"29202153-17f9-4caa-87aa-090e8cfd74fc\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"29202153-17f9-4caa-87aa-090e8cfd74fc\")) {                    Plotly.newPlot(                        \"29202153-17f9-4caa-87aa-090e8cfd74fc\",                        [{\"marker\":{\"color\":[\"red\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\"],\"size\":14,\"symbol\":[\"star\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\"]},\"mode\":\"markers+text\",\"text\":[\"pennsylvania\",\"delaware\",\"carolina\",\"maryland\",\"virginia\",\"1832\",\"york\",\"1650\",\"connecticut\",\"massachusetts\",\"island\"],\"textposition\":\"top center\",\"x\":{\"dtype\":\"f4\",\"bdata\":\"+B3\\u002fwNzH58DFSejAzIX7wLPWB8FVhd7AzqMAwe67zcCRS9TA6Z4Kwdcmx8A=\"},\"y\":{\"dtype\":\"f4\",\"bdata\":\"NOYQQdLjC0H6cBpB\\u002fQ8dQf1aIEHTKydB9CcFQY51HEH\\u002foQpBbCQDQRtaA0E=\"},\"type\":\"scatter\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#242424\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scattermap\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermap\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#242424\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#1864ab\"],[0.14285714285714285,\"#7065b9\"],[0.2857142857142857,\"#af61b7\"],[0.42857142857142855,\"#e35ea5\"],[0.5714285714285714,\"#ff6587\"],[0.7142857142857143,\"#ff7c63\"],[0.8571428571428571,\"#ff9e3d\"],[1.0,\"#fcc419\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#1971c2\",\"#e03131\",\"#2f9e44\",\"#6741d9\",\"#e8590c\",\"#0c8599\",\"#c2255c\",\"#f08c00\"],\"font\":{\"color\":\"#f2f5fa\",\"family\":\"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji\"},\"geo\":{\"bgcolor\":\"#242424\",\"lakecolor\":\"#242424\",\"landcolor\":\"#242424\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\",\"font\":{\"family\":\"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji\"}},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"#242424\",\"piecolorway\":[\"#1971c2\",\"#e03131\",\"#2f9e44\",\"#6741d9\",\"#e8590c\",\"#0c8599\",\"#c2255c\",\"#f08c00\"],\"plot_bgcolor\":\"#242424\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#343a40\",\"gridwidth\":0.5,\"linecolor\":\"#506784\",\"rangeselector\":{\"activecolor\":\"#868e96\",\"bgcolor\":\"#495057\",\"font\":{\"color\":\"white\"}},\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#343a40\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#343a40\",\"gridwidth\":0.5,\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#343a40\",\"zerolinewidth\":2}}},\"title\":{\"text\":\"Nearest neighbors of 'pennsylvania'\"}},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('29202153-17f9-4caa-87aa-090e8cfd74fc');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };            </script>        </div>\n```\n:::\n:::\n\n\n::: {#281ee416 .cell .light-mode execution_count=15}\n``` {.python .cell-code}\nplot_neighbors(\"nobles\", embeddings, 10, \"light\")\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.3.1.min.js\" integrity=\"sha256-4rD3fugVb/nVJYUv5Ky3v+fYXoouHaBSP20WIJuEiWg=\" crossorigin=\"anonymous\"></script>                <div id=\"5618e978-1b60-4b5d-b9b5-63be2f45ecb3\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"5618e978-1b60-4b5d-b9b5-63be2f45ecb3\")) {                    Plotly.newPlot(                        \"5618e978-1b60-4b5d-b9b5-63be2f45ecb3\",                        [{\"marker\":{\"color\":[\"red\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\"],\"size\":14,\"symbol\":[\"star\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\"]},\"mode\":\"markers+text\",\"text\":[\"nobles\",\"hamilton\",\"church\",\"aggregate\",\"orsini\",\"punish\",\"1788.\",\"suffrages\",\"english\",\"selected\",\"anglo-american\"],\"textposition\":\"top center\",\"x\":{\"dtype\":\"f4\",\"bdata\":\"47tJQRiIQ0EP+FFB6dpmQR9xXUGBH1BBFDc\\u002fQcAZYUFJc1RBNFlfQaoEakE=\"},\"y\":{\"dtype\":\"f4\",\"bdata\":\"OuTMQPzx4EA2cb9AA0LlQLUH9UDXTflAzNXxQPyp0UCBi9hAfue0QJ3BxUA=\"},\"type\":\"scatter\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#ffffff\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scattermap\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermap\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#ffffff\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#1864ab\"],[0.14285714285714285,\"#7065b9\"],[0.2857142857142857,\"#af61b7\"],[0.42857142857142855,\"#e35ea5\"],[0.5714285714285714,\"#ff6587\"],[0.7142857142857143,\"#ff7c63\"],[0.8571428571428571,\"#ff9e3d\"],[1.0,\"#fcc419\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#228be6\",\"#fa5252\",\"#40c057\",\"#7950f2\",\"#fd7e14\",\"#15aabf\",\"#e64980\",\"#fab005\"],\"font\":{\"color\":\"#2a3f5f\",\"family\":\"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji\"},\"geo\":{\"bgcolor\":\"#ffffff\",\"lakecolor\":\"#ffffff\",\"landcolor\":\"#ffffff\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#C8D4E3\"},\"hoverlabel\":{\"align\":\"left\",\"font\":{\"family\":\"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji\"}},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"#ffffff\",\"piecolorway\":[\"#228be6\",\"#fa5252\",\"#40c057\",\"#7950f2\",\"#fd7e14\",\"#15aabf\",\"#e64980\",\"#fab005\"],\"plot_bgcolor\":\"#ffffff\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"radialaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"yaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"zaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"caxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#dee2e6\",\"gridwidth\":0.5,\"linecolor\":\"#EBF0F8\",\"rangeselector\":{\"activecolor\":\"#868e96\",\"bgcolor\":\"#adb5bd\",\"font\":{\"color\":\"white\"}},\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#dee2e6\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#dee2e6\",\"gridwidth\":0.5,\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#dee2e6\",\"zerolinewidth\":2}}},\"title\":{\"text\":\"Nearest neighbors of 'nobles'\"}},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('5618e978-1b60-4b5d-b9b5-63be2f45ecb3');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };            </script>        </div>\n```\n:::\n:::\n\n\n::: {#9deb615f .cell .dark-mode execution_count=16}\n``` {.python .cell-code}\nplot_neighbors(\"nobles\", embeddings, 10, \"dark\")\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.3.1.min.js\" integrity=\"sha256-4rD3fugVb/nVJYUv5Ky3v+fYXoouHaBSP20WIJuEiWg=\" crossorigin=\"anonymous\"></script>                <div id=\"94fbb86c-1147-4da1-a503-22186f27f15a\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"94fbb86c-1147-4da1-a503-22186f27f15a\")) {                    Plotly.newPlot(                        \"94fbb86c-1147-4da1-a503-22186f27f15a\",                        [{\"marker\":{\"color\":[\"red\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\"],\"size\":14,\"symbol\":[\"star\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\"]},\"mode\":\"markers+text\",\"text\":[\"nobles\",\"hamilton\",\"church\",\"aggregate\",\"orsini\",\"punish\",\"1788.\",\"suffrages\",\"english\",\"selected\",\"anglo-american\"],\"textposition\":\"top center\",\"x\":{\"dtype\":\"f4\",\"bdata\":\"47tJQRiIQ0EP+FFB6dpmQR9xXUGBH1BBFDc\\u002fQcAZYUFJc1RBNFlfQaoEakE=\"},\"y\":{\"dtype\":\"f4\",\"bdata\":\"OuTMQPzx4EA2cb9AA0LlQLUH9UDXTflAzNXxQPyp0UCBi9hAfue0QJ3BxUA=\"},\"type\":\"scatter\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#242424\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scattermap\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermap\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#242424\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#1864ab\"],[0.14285714285714285,\"#7065b9\"],[0.2857142857142857,\"#af61b7\"],[0.42857142857142855,\"#e35ea5\"],[0.5714285714285714,\"#ff6587\"],[0.7142857142857143,\"#ff7c63\"],[0.8571428571428571,\"#ff9e3d\"],[1.0,\"#fcc419\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#1971c2\",\"#e03131\",\"#2f9e44\",\"#6741d9\",\"#e8590c\",\"#0c8599\",\"#c2255c\",\"#f08c00\"],\"font\":{\"color\":\"#f2f5fa\",\"family\":\"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji\"},\"geo\":{\"bgcolor\":\"#242424\",\"lakecolor\":\"#242424\",\"landcolor\":\"#242424\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\",\"font\":{\"family\":\"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji\"}},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"#242424\",\"piecolorway\":[\"#1971c2\",\"#e03131\",\"#2f9e44\",\"#6741d9\",\"#e8590c\",\"#0c8599\",\"#c2255c\",\"#f08c00\"],\"plot_bgcolor\":\"#242424\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#343a40\",\"gridwidth\":0.5,\"linecolor\":\"#506784\",\"rangeselector\":{\"activecolor\":\"#868e96\",\"bgcolor\":\"#495057\",\"font\":{\"color\":\"white\"}},\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#343a40\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#343a40\",\"gridwidth\":0.5,\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#343a40\",\"zerolinewidth\":2}}},\"title\":{\"text\":\"Nearest neighbors of 'nobles'\"}},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('94fbb86c-1147-4da1-a503-22186f27f15a');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };            </script>        </div>\n```\n:::\n:::\n\n\n::: {#3ae82887 .cell .light-mode execution_count=17}\n``` {.python .cell-code}\nplot_neighbors(\"war\", embeddings, 10, \"light\")\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.3.1.min.js\" integrity=\"sha256-4rD3fugVb/nVJYUv5Ky3v+fYXoouHaBSP20WIJuEiWg=\" crossorigin=\"anonymous\"></script>                <div id=\"b10b1743-47a6-43d1-bd46-b989b084c6cd\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"b10b1743-47a6-43d1-bd46-b989b084c6cd\")) {                    Plotly.newPlot(                        \"b10b1743-47a6-43d1-bd46-b989b084c6cd\",                        [{\"marker\":{\"color\":[\"red\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\"],\"size\":14,\"symbol\":[\"star\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\"]},\"mode\":\"markers+text\",\"text\":[\"war\",\"peace\",\"of\",\"civil\",\"art\",\",\",\"sun\",\"]\",\"and\",\"europe\",\"in\"],\"textposition\":\"top center\",\"x\":{\"dtype\":\"f4\",\"bdata\":\"0U5DQcqQOkHaqzhBgbouQQ06OUGVezxBcxlOQepGR0HMbi1BUUpHQSwoMUE=\"},\"y\":{\"dtype\":\"f4\",\"bdata\":\"hbWXQZrckUEXbotBMryUQXFwmkFIgoRBn\\u002f+LQeachUE7D4pB8tCRQeFZhEE=\"},\"type\":\"scatter\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#2a3f5f\"},\"error_y\":{\"color\":\"#2a3f5f\"},\"marker\":{\"line\":{\"color\":\"white\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"baxis\":{\"endlinecolor\":\"#2a3f5f\",\"gridcolor\":\"#C8D4E3\",\"linecolor\":\"#C8D4E3\",\"minorgridcolor\":\"#C8D4E3\",\"startlinecolor\":\"#2a3f5f\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#ffffff\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scattermap\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermap\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#ffffff\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#EBF0F8\"},\"line\":{\"color\":\"white\"}},\"header\":{\"fill\":{\"color\":\"#C8D4E3\"},\"line\":{\"color\":\"white\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#2a3f5f\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#1864ab\"],[0.14285714285714285,\"#7065b9\"],[0.2857142857142857,\"#af61b7\"],[0.42857142857142855,\"#e35ea5\"],[0.5714285714285714,\"#ff6587\"],[0.7142857142857143,\"#ff7c63\"],[0.8571428571428571,\"#ff9e3d\"],[1.0,\"#fcc419\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#228be6\",\"#fa5252\",\"#40c057\",\"#7950f2\",\"#fd7e14\",\"#15aabf\",\"#e64980\",\"#fab005\"],\"font\":{\"color\":\"#2a3f5f\",\"family\":\"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji\"},\"geo\":{\"bgcolor\":\"#ffffff\",\"lakecolor\":\"#ffffff\",\"landcolor\":\"#ffffff\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#C8D4E3\"},\"hoverlabel\":{\"align\":\"left\",\"font\":{\"family\":\"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji\"}},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"light\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"#ffffff\",\"piecolorway\":[\"#228be6\",\"#fa5252\",\"#40c057\",\"#7950f2\",\"#fd7e14\",\"#15aabf\",\"#e64980\",\"#fab005\"],\"plot_bgcolor\":\"#ffffff\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"radialaxis\":{\"gridcolor\":\"#EBF0F8\",\"linecolor\":\"#EBF0F8\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"yaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"},\"zaxis\":{\"backgroundcolor\":\"white\",\"gridcolor\":\"#DFE8F3\",\"gridwidth\":2,\"linecolor\":\"#EBF0F8\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#EBF0F8\"}},\"shapedefaults\":{\"line\":{\"color\":\"#2a3f5f\"}},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"},\"bgcolor\":\"white\",\"caxis\":{\"gridcolor\":\"#DFE8F3\",\"linecolor\":\"#A2B1C6\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#dee2e6\",\"gridwidth\":0.5,\"linecolor\":\"#EBF0F8\",\"rangeselector\":{\"activecolor\":\"#868e96\",\"bgcolor\":\"#adb5bd\",\"font\":{\"color\":\"white\"}},\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#dee2e6\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#dee2e6\",\"gridwidth\":0.5,\"linecolor\":\"#EBF0F8\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#dee2e6\",\"zerolinewidth\":2}}},\"title\":{\"text\":\"Nearest neighbors of 'war'\"}},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('b10b1743-47a6-43d1-bd46-b989b084c6cd');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };            </script>        </div>\n```\n:::\n:::\n\n\n::: {#b0a99ba1 .cell .dark-mode execution_count=18}\n``` {.python .cell-code}\nplot_neighbors(\"war\", embeddings, 10, \"dark\")\n```\n\n::: {.cell-output .cell-output-display}\n```{=html}\n<div>            <script src=\"https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG\"></script><script type=\"text/javascript\">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}</script>                <script type=\"text/javascript\">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>\n        <script charset=\"utf-8\" src=\"https://cdn.plot.ly/plotly-3.3.1.min.js\" integrity=\"sha256-4rD3fugVb/nVJYUv5Ky3v+fYXoouHaBSP20WIJuEiWg=\" crossorigin=\"anonymous\"></script>                <div id=\"7fc131ce-9ff8-4b66-a480-eb1708d36bc4\" class=\"plotly-graph-div\" style=\"height:525px; width:100%;\"></div>            <script type=\"text/javascript\">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById(\"7fc131ce-9ff8-4b66-a480-eb1708d36bc4\")) {                    Plotly.newPlot(                        \"7fc131ce-9ff8-4b66-a480-eb1708d36bc4\",                        [{\"marker\":{\"color\":[\"red\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\",\"blue\"],\"size\":14,\"symbol\":[\"star\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\",\"circle\"]},\"mode\":\"markers+text\",\"text\":[\"war\",\"peace\",\"of\",\"civil\",\"art\",\",\",\"sun\",\"]\",\"and\",\"europe\",\"in\"],\"textposition\":\"top center\",\"x\":{\"dtype\":\"f4\",\"bdata\":\"0U5DQcqQOkHaqzhBgbouQQ06OUGVezxBcxlOQepGR0HMbi1BUUpHQSwoMUE=\"},\"y\":{\"dtype\":\"f4\",\"bdata\":\"hbWXQZrckUEXbotBMryUQXFwmkFIgoRBn\\u002f+LQeachUE7D4pB8tCRQeFZhEE=\"},\"type\":\"scatter\"}],                        {\"template\":{\"data\":{\"barpolar\":[{\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"barpolar\"}],\"bar\":[{\"error_x\":{\"color\":\"#f2f5fa\"},\"error_y\":{\"color\":\"#f2f5fa\"},\"marker\":{\"line\":{\"color\":\"rgb(17,17,17)\",\"width\":0.5},\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"bar\"}],\"carpet\":[{\"aaxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"baxis\":{\"endlinecolor\":\"#A2B1C6\",\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"minorgridcolor\":\"#506784\",\"startlinecolor\":\"#A2B1C6\"},\"type\":\"carpet\"}],\"choropleth\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"choropleth\"}],\"contourcarpet\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"contourcarpet\"}],\"contour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"contour\"}],\"heatmap\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"heatmap\"}],\"histogram2dcontour\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2dcontour\"}],\"histogram2d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"histogram2d\"}],\"histogram\":[{\"marker\":{\"pattern\":{\"fillmode\":\"overlay\",\"size\":10,\"solidity\":0.2}},\"type\":\"histogram\"}],\"mesh3d\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"type\":\"mesh3d\"}],\"parcoords\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"parcoords\"}],\"pie\":[{\"automargin\":true,\"type\":\"pie\"}],\"scatter3d\":[{\"line\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatter3d\"}],\"scattercarpet\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattercarpet\"}],\"scattergeo\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattergeo\"}],\"scattergl\":[{\"marker\":{\"line\":{\"color\":\"#242424\"}},\"type\":\"scattergl\"}],\"scattermapbox\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermapbox\"}],\"scattermap\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scattermap\"}],\"scatterpolargl\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolargl\"}],\"scatterpolar\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterpolar\"}],\"scatter\":[{\"marker\":{\"line\":{\"color\":\"#242424\"}},\"type\":\"scatter\"}],\"scatterternary\":[{\"marker\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"type\":\"scatterternary\"}],\"surface\":[{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"},\"colorscale\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]],\"type\":\"surface\"}],\"table\":[{\"cells\":{\"fill\":{\"color\":\"#506784\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"header\":{\"fill\":{\"color\":\"#2a3f5f\"},\"line\":{\"color\":\"rgb(17,17,17)\"}},\"type\":\"table\"}]},\"layout\":{\"annotationdefaults\":{\"arrowcolor\":\"#f2f5fa\",\"arrowhead\":0,\"arrowwidth\":1},\"autotypenumbers\":\"strict\",\"coloraxis\":{\"colorbar\":{\"outlinewidth\":0,\"ticks\":\"\"}},\"colorscale\":{\"diverging\":[[0,\"#8e0152\"],[0.1,\"#c51b7d\"],[0.2,\"#de77ae\"],[0.3,\"#f1b6da\"],[0.4,\"#fde0ef\"],[0.5,\"#f7f7f7\"],[0.6,\"#e6f5d0\"],[0.7,\"#b8e186\"],[0.8,\"#7fbc41\"],[0.9,\"#4d9221\"],[1,\"#276419\"]],\"sequential\":[[0.0,\"#1864ab\"],[0.14285714285714285,\"#7065b9\"],[0.2857142857142857,\"#af61b7\"],[0.42857142857142855,\"#e35ea5\"],[0.5714285714285714,\"#ff6587\"],[0.7142857142857143,\"#ff7c63\"],[0.8571428571428571,\"#ff9e3d\"],[1.0,\"#fcc419\"]],\"sequentialminus\":[[0.0,\"#0d0887\"],[0.1111111111111111,\"#46039f\"],[0.2222222222222222,\"#7201a8\"],[0.3333333333333333,\"#9c179e\"],[0.4444444444444444,\"#bd3786\"],[0.5555555555555556,\"#d8576b\"],[0.6666666666666666,\"#ed7953\"],[0.7777777777777778,\"#fb9f3a\"],[0.8888888888888888,\"#fdca26\"],[1.0,\"#f0f921\"]]},\"colorway\":[\"#1971c2\",\"#e03131\",\"#2f9e44\",\"#6741d9\",\"#e8590c\",\"#0c8599\",\"#c2255c\",\"#f08c00\"],\"font\":{\"color\":\"#f2f5fa\",\"family\":\"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji\"},\"geo\":{\"bgcolor\":\"#242424\",\"lakecolor\":\"#242424\",\"landcolor\":\"#242424\",\"showlakes\":true,\"showland\":true,\"subunitcolor\":\"#506784\"},\"hoverlabel\":{\"align\":\"left\",\"font\":{\"family\":\"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji\"}},\"hovermode\":\"closest\",\"mapbox\":{\"style\":\"dark\"},\"margin\":{\"b\":0,\"l\":0,\"r\":0,\"t\":30},\"paper_bgcolor\":\"#242424\",\"piecolorway\":[\"#1971c2\",\"#e03131\",\"#2f9e44\",\"#6741d9\",\"#e8590c\",\"#0c8599\",\"#c2255c\",\"#f08c00\"],\"plot_bgcolor\":\"#242424\",\"polar\":{\"angularaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"radialaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"scene\":{\"xaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"yaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"},\"zaxis\":{\"backgroundcolor\":\"rgb(17,17,17)\",\"gridcolor\":\"#506784\",\"gridwidth\":2,\"linecolor\":\"#506784\",\"showbackground\":true,\"ticks\":\"\",\"zerolinecolor\":\"#C8D4E3\"}},\"shapedefaults\":{\"line\":{\"color\":\"#f2f5fa\"}},\"sliderdefaults\":{\"bgcolor\":\"#C8D4E3\",\"bordercolor\":\"rgb(17,17,17)\",\"borderwidth\":1,\"tickwidth\":0},\"ternary\":{\"aaxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"baxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"},\"bgcolor\":\"rgb(17,17,17)\",\"caxis\":{\"gridcolor\":\"#506784\",\"linecolor\":\"#506784\",\"ticks\":\"\"}},\"title\":{\"x\":0.05},\"updatemenudefaults\":{\"bgcolor\":\"#506784\",\"borderwidth\":0},\"xaxis\":{\"automargin\":true,\"gridcolor\":\"#343a40\",\"gridwidth\":0.5,\"linecolor\":\"#506784\",\"rangeselector\":{\"activecolor\":\"#868e96\",\"bgcolor\":\"#495057\",\"font\":{\"color\":\"white\"}},\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#343a40\",\"zerolinewidth\":2},\"yaxis\":{\"automargin\":true,\"gridcolor\":\"#343a40\",\"gridwidth\":0.5,\"linecolor\":\"#506784\",\"ticks\":\"\",\"title\":{\"standoff\":15},\"zerolinecolor\":\"#343a40\",\"zerolinewidth\":2}}},\"title\":{\"text\":\"Nearest neighbors of 'war'\"}},                        {\"responsive\": true}                    ).then(function(){\n                            \nvar gd = document.getElementById('7fc131ce-9ff8-4b66-a480-eb1708d36bc4');\nvar x = new MutationObserver(function (mutations, observer) {{\n        var display = window.getComputedStyle(gd).display;\n        if (!display || display === 'none') {{\n            console.log([gd, 'removed!']);\n            Plotly.purge(gd);\n            observer.disconnect();\n        }}\n}});\n\n// Listen for the removal of the full notebook cells\nvar notebookContainer = gd.closest('#notebook-container');\nif (notebookContainer) {{\n    x.observe(notebookContainer, {childList: true});\n}}\n\n// Listen for the clearing of the current output cell\nvar outputEl = gd.closest('.output');\nif (outputEl) {{\n    x.observe(outputEl, {childList: true});\n}}\n\n                        })                };            </script>        </div>\n```\n:::\n:::\n\n\n# Conclusion\n\nIn this short post we did a deep dive on the GloVE algorithm. Specifically, we focused on how training examples are generated, how the loss function is defined, and implementing it with JAX.  \n\n",
    "supporting": [
      "index_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n<script type=\"text/javascript\">\nwindow.PlotlyConfig = {MathJaxConfig: 'local'};\nif (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: \"STIX-Web\"}});}\n</script>\n<script type=\"module\">import \"https://cdn.plot.ly/plotly-3.3.1.min\"</script>\n\n"
      ]
    }
  }
}